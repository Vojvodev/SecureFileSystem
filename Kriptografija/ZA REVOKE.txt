// Load the certificate to be revoked from a file
X509* cert = PEM_read_X509(fp, NULL, NULL, NULL);

// Generate a new CRL
X509_CRL* crl = X509_CRL_new();

// Set the issuer of the CRL (should be the same as the CA that issued the certificate)
X509_NAME* name = X509_get_issuer_name(cert);
X509_CRL_set_issuer_name(crl, name);

// Add the serial number of the certificate to be revoked to the CRL
X509_REVOKED* revoked = X509_REVOKED_new();
ASN1_INTEGER* serial = X509_get_serialNumber(cert);
X509_REVOKED_set_serialNumber(revoked, serial);
X509_CRL_add0_revoked(crl, revoked);

// Set the date and time of the revocation
ASN1_TIME* tm = ASN1_TIME_new();
ASN1_TIME_set(tm, time(NULL));
X509_REVOKED_set_revocationDate(revoked, tm);

// Sign the CRL using the private key of the CA
X509* ca_cert = ...; // Load the CA certificate
EVP_PKEY* ca_key = ...; // Load the private key of the CA
X509_CRL_set_version(crl, 1);
X509_CRL_sign(crl, ca_key, EVP_sha256());

// Save the CRL to a file
FILE* crl_fp = fopen("crl.pem", "w");
PEM_write_X509_CRL(crl_fp, crl);
fclose(crl_fp);